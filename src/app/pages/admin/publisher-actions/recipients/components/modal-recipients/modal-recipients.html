<div class='container'>
  <h1 mat-dialog-title>{{data.title | uppercase }}</h1>
  <div class='reload-button'>
    <button mat-mini-fab color='primary' title='Recargar plantillas' (click)='onRefresh()'>
      <mat-icon>refresh</mat-icon>
    </button>
  </div>
  <div mat-dialog-content>
    <!--TODO: Poner boton de refresh en el formulario -->
    <form [formGroup]='mailUserForm.baseForm' (ngSubmit)='onSave()' fxLayout='column'
          (keydown.enter)='$event.preventDefault()'>
      <div fxLayout='row' fxLayoutAlign='space-between center'>
        <!-- Name -->
        <mat-form-field hideRequiredMarker appearance='outline' fxFlex='47'>
          <mat-label>Nombre</mat-label>
          <label>
            <input type='text' matInput required formControlName='nombre'>
          </label>
          <mat-icon matSuffix>account_circle</mat-icon>
          <mat-error *ngIf="checkField('nombre', null, null)">{{mailUserForm.errorsMessage["nombre"]}}</mat-error>
        </mat-form-field>
        <!-- Lastname -->
        <mat-form-field hideRequiredMarker appearance='outline' fxFlex='47'>
          <mat-label>Apellidos</mat-label>
          <label>
            <input type='text' matInput required formControlName='apellido'>
          </label>
          <mat-icon matSuffix>account_circle</mat-icon>
          <mat-error *ngIf="checkField('apellido',null, null)">{{mailUserForm.errorsMessage["apellido"]}}</mat-error>
        </mat-form-field>
      </div>
      <!-- ID -->
      <div fxLayout='row' fxLayoutAlign='space-between center'>
        <!-- ID type -->
        <mat-form-field hideRequiredMarker fxFlex='47' formGroupName='id' appearance='outline'>
          <mat-label>Tipo de documento</mat-label>
          <mat-select formControlName='tipoIdentificacion'>
            <mat-option>-- Seleccione una opción --</mat-option>
            <mat-option value='CA'>CARNET</mat-option>
            <mat-option value='CC'>CEDULA DE CIUDADANIA</mat-option>
            <mat-option value='CE'>CEDULA DE ESTRAJERIA</mat-option>
            <mat-option value='PA'>PASAPORTE</mat-option>
            <mat-option value='PT'>PERMISO TRABAJO</mat-option>
            <mat-option value='RC'>REGISTRO CIVIL</mat-option>
            <mat-option value='TI'>TARJETA IDENTIDAD</mat-option>
            <mat-option value='VI'>VISA</mat-option>
          </mat-select>
          <mat-icon matSuffix>account_box</mat-icon>
          <mat-error *ngIf="checkField('tipoIdentificacion','id', null)">
            {{mailUserForm.errorsMessage['id'].tipoIdentificacion}}</mat-error>
        </mat-form-field>
        <!-- ID number -->
        <mat-form-field hideRequiredMarker appearance='outline' fxFlex='47' formGroupName='id'>
          <mat-label>Número de identificación</mat-label>
          <label>
            <input type='text' matInput required formControlName='numeroIdentificacion'
            >
          </label>
          <mat-icon matSuffix>account_box</mat-icon>
          <mat-error *ngIf="checkField('numeroIdentificacion','id', null )">
            {{mailUserForm.errorsMessage['id'].numeroIdentificacion}}</mat-error>
        </mat-form-field>
      </div>
      <!-- Birhtday/Gender -->
      <div fxLayout='row' fxLayoutAlign='space-between center'>
        <!-- Birhtday -->
        <mat-form-field fxFlex='47' appearance='outline'>
          <mat-label>Fecha de nacimiento</mat-label>
          <label>
            <input matInput [matDatepicker]='dp' [max]='today' formControlName='fechaNacimiento'
                   (dateChange)='setBirthdayFormat($event)' placeholder='YYYY-MM-DD'>
          </label>
          <mat-datepicker-toggle matSuffix [for]='dp'></mat-datepicker-toggle>
          <mat-datepicker #dp></mat-datepicker>
          <mat-error *ngIf="checkField('fechaNacimiento', null, null)">{{mailUserForm.errorsMessage["fechaNacimiento"]}}
          </mat-error>
        </mat-form-field>
        <!-- Gender -->
        <mat-form-field fxFlex='47' appearance='outline'>
          <mat-label>Género</mat-label>
          <mat-select formControlName='genero'>
            <mat-option>-- Seleccione una opción --</mat-option>
            <mat-option value='MASCULINO'>MASCULINO</mat-option>
            <mat-option value='FEMENINO'>FEMENINO</mat-option>
          </mat-select>
          <mat-icon matSuffix>group</mat-icon>
          <mat-error *ngIf="checkField('genero', null, null)">
            {{mailUserForm.errorsMessage["genero"]}}</mat-error>
        </mat-form-field>
      </div>
      <!-- Email/State -->
      <div fxLayout='row' fxLayoutAlign='space-between center'>
        <!-- Email -->
        <mat-form-field fxFlex='47' appearance='outline' hideRequiredMarker='true'>
          <mat-label>Email</mat-label>
          <label>
            <input type='text' matInput required formControlName='email'>
          </label>
          <mat-error *ngIf="checkField('email', null, null)">{{mailUserForm.errorsMessage["email"]}}</mat-error>
          <mat-icon matSuffix>contact_mail</mat-icon>
        </mat-form-field>
        <!-- State -->
        <mat-form-field fxFlex='47' hideRequiredMarker appearance='outline'>
          <mat-label>Estado</mat-label>
          <mat-select #state formControlName='estado'>
            <mat-option>-- Seleccione una opción --</mat-option>
            <mat-option value='ACTIVO'>ACTIVO</mat-option>
            <mat-option value='INACTIVO'>INACTIVO</mat-option>
          </mat-select>
          <ng-container [ngSwitch]='state.value' matSuffix>
            <mat-icon *ngSwitchCase="'ACTIVO'" matSuffix>email</mat-icon>
            <mat-icon *ngSwitchCase="'INACTIVO'" matSuffix>unsubscribe</mat-icon>
            <mat-icon *ngSwitchDefault matSuffix>contact_mail</mat-icon>
          </ng-container>
          <mat-error *ngIf="checkField('estado', null, null)">
            {{mailUserForm.errorsMessage["estado"]}}</mat-error>
        </mat-form-field>
      </div>
      <!-- Administrative units -->
      <ng-select
        [items]='administrativeUnits'
        bindLabel='nombre'
        placeholder='Unidad Administrativa'
        appearance='outline'
        notFoundText='No hay más unidades administrativas en la lista!'
        typeToSearchText='Search'
        title='Seleccione las unidadades administrativas del destinatario'
        required
        [loading]='true'
        [multiple]='true'
        [minTermLength]='3'
        [hideSelected]='true'
        [closeOnSelect]='false'
        [clearSearchOnAdd]='true'
        [selectableGroupAsModel]='true'
        formControlName='unidadAdministrativaPorCorreoUsuario'>
        <ng-template ng-option-tmp let-administrativeUnits='item'>
          <ng-container>
            <mat-icon>badge</mat-icon>
          </ng-container>
          {{administrativeUnits.nombre| uppercase}}
        </ng-template>
      </ng-select>
      <!-- Academic program-->
      <ng-select
        [items]='programs'
        bindLabel='nombre'
        placeholder='Programa acádemico'
        appearance='outline'
        notFoundText='No hay más programas academicos en la lista!'
        typeToSearchText='Search'
        title='Seleccione el programa/s del destinatario'
        [loading]='true'
        [multiple]='true'
        [minTermLength]='3'
        [hideSelected]='true'
        [closeOnSelect]='false'
        [clearSearchOnAdd]='true'
        [selectableGroupAsModel]='true'
        formControlName='programaAcademicoPorUsuarioCorreo'>
        <ng-template ng-option-tmp let-program='item'>
          <ng-container>
            <mat-icon> school</mat-icon>
          </ng-container>
          {{program.nombre| uppercase}}
        </ng-template>
      </ng-select>
      <!-- Bonding -->
      <ng-select
        [items]='bondingTypes'
        bindLabel='nombre'
        placeholder='Estamento'
        appearance='outline'
        notFoundText='No hay más vinculaciones en la lista!'
        typeToSearchText='Search'
        required
        title='Seleccione el estamento/s del destinatario'
        [loading]='true'
        [multiple]='true'
        [minTermLength]='3'
        [hideSelected]='true'
        [closeOnSelect]='false'
        [clearSearchOnAdd]='true'
        [selectableGroupAsModel]='true'
        formControlName='vinculacionPorUsuarioCorreo'>
        <ng-template ng-option-tmp let-bondingType='item'>
          <ng-container>
            <mat-icon> group_work</mat-icon>
          </ng-container>
          {{bondingType.nombre| uppercase}}
        </ng-template>
      </ng-select>
      <!-- Platform -->
      <ng-select
        [items]='platforms'
        bindLabel='nombre'
        placeholder='Plataforma'
        appearance='outline'
        notFoundText='No hay más plataformas en la lista!'
        typeToSearchText='Search'
        title='Seleccione la plataforma/s del destinatario'
        required
        [loading]='true'
        [multiple]='true'
        [minTermLength]='3'
        [hideSelected]='true'
        [closeOnSelect]='false'
        [clearSearchOnAdd]='true'
        [selectableGroupAsModel]='true'
        formControlName='plataformaPorUsuarioCorreo'>
        <ng-template ng-option-tmp let-bondingType='item'>
          <ng-container>
            <mat-icon> storage</mat-icon>
          </ng-container>
          {{bondingType.nombre| uppercase}}
        </ng-template>
      </ng-select>
    </form>
  </div>
  <div mat-dialog-actions fxLayout='row' fxLayoutAlign='end end'>
    <button mat-raised-button fxFlex='20' color='warn' (click)='onClose(null)'>Cancelar</button>
    <button mat-raised-button fxFlex='20' [disabled]='mailUserForm.baseForm.invalid' color='primary' (click)='onSave()'>
      {{actionTODO}}
    </button>
  </div>
</div>
